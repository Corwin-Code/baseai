# ==================================================================================
# BaseAI åº”ç”¨é…ç½®æ–‡ä»¶ - åŸºäºSpring Bootçš„AIå¹³å°æ ¸å¿ƒé…ç½®æ–‡ä»¶
# ==================================================================================

# =================== åº”ç”¨åŸºç¡€é…ç½® ===================
spring:
  application:
    # åº”ç”¨å
    name: baseai
  main:
    # æ‡’åŠ è½½
    lazy-initialization: false
    allow-bean-definition-overriding: false

  # =================== æ•°æ®åº“é…ç½® ===================
  datasource:
    driver-class-name: org.postgresql.Driver
    url: jdbc:postgresql://${DB_HOST:172.18.20.209}:${DB_PORT:5432}/${DB_DATABASE:baseai}
    username: ${DB_USERNAME:username}
    password: ${DB_PASSWORD:password}

    # HikariCP è¿æ¥æ± é…ç½®
    hikari:
      pool-name: BaseAI-HikariCP
      # æœ€å°ç©ºé—²è¿æ¥æ•°ï¼Œä¿è¯åŸºæœ¬çš„å¹¶å‘å¤„ç†èƒ½åŠ›
      minimum-idle: ${DB_POOL_MIN_IDLE:5}
      # æœ€å¤§è¿æ¥æ•°ï¼Œé¿å…æ•°æ®åº“è¿æ¥è¿‡å¤š
      maximum-pool-size: ${DB_POOL_MAX_SIZE:20}
      # ç©ºé—²è¿æ¥çš„æœ€å¤§ç”Ÿå­˜æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ï¼Œé˜²æ­¢è¿æ¥é•¿æ—¶é—´å ç”¨
      idle-timeout: ${DB_POOL_IDLE_TIMEOUT:300000}
      # è¿æ¥çš„æœ€å¤§ç”Ÿå­˜æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ï¼Œé˜²æ­¢è¿æ¥è€åŒ–
      max-lifetime: ${DB_POOL_MAX_LIFETIME:1800000}
      # è·å–è¿æ¥çš„è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ï¼Œé¿å…é•¿æ—¶é—´ç­‰å¾…
      connection-timeout: ${DB_POOL_CONNECTION_TIMEOUT:30000}
      # è¿æ¥æ³„æ¼æ£€æµ‹é˜ˆå€¼ï¼Œå¸®åŠ©å‘ç°ä»£ç ä¸­çš„è¿æ¥æ³„æ¼é—®é¢˜
      leak-detection-threshold: 60000

  # =================== JPA/Hibernate é…ç½® ===================
  jpa:
    # å…³é—­ Open-In-Viewï¼Œé¿å…æ‡’åŠ è½½é—®é¢˜
    open-in-view: false
    # æ˜¯å¦åœ¨æ§åˆ¶å°æ‰“å° SQL
    show-sql: ${JPA_SHOW_SQL:true}
    hibernate:
      # ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ validateï¼Œå¼€å‘ç¯å¢ƒå¯ä»¥ä½¿ç”¨ update(è‡ªåŠ¨æ›´æ–°è¡¨ç»“æ„)
      ddl-auto: ${JPA_DDL_AUTO:update}
      # ä½¿ç”¨ä¸‹åˆ’çº¿å‘½åç­–ç•¥ï¼Œç¬¦åˆæ•°æ®åº“å‘½åè§„èŒƒ
      naming:
        physical-strategy: org.hibernate.boot.model.naming.CamelCaseToUnderscoresNamingStrategy
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true
        use_sql_comments: false
        # æ‰¹é‡æ“ä½œä¼˜åŒ–
        jdbc:
          batch_size: 25
          order_inserts: true
          order_updates: true
          # äºŒçº§ç¼“å­˜é…ç½®
        cache:
          use_second_level_cache: false

  # =================== Redis ç¼“å­˜é…ç½® ===================
  data:
    redis:
      # Redis ä¸»æœº
      host: ${REDIS_HOST:172.18.20.209}
      # ç«¯å£
      port: ${REDIS_PORT:6379}
      # å¯†ç ï¼ˆç”Ÿäº§èµ°å¯†ç®¡ï¼‰
      password: ${REDIS_PASSWORD:}
      # åº“åºå·ï¼ˆ0~15ï¼‰
      database: ${REDIS_DATABASE:0}
      # å‘½ä»¤è¶…æ—¶ï¼ˆå»ºè®®ç”¨ Durationï¼Œç¤ºä¾‹ 8 ç§’ï¼‰
      timeout: ${REDIS_TIMEOUT:8s}
      # è¿æ¥è¶…æ—¶ï¼ˆç¤ºä¾‹ 5 ç§’ï¼‰
      connect-timeout: ${REDIS_CONNECT_TIMEOUT:5s}

      # Lettuce è¿æ¥æ± é…ç½®ï¼ˆæ¨èä½¿ç”¨ Lettuce è€Œä¸æ˜¯ Jedisï¼‰
      lettuce:
        pool:
          # æœ€å¤§è¿æ¥æ•°ï¼ˆå¹¶å‘é€‚ä¸­èµ·æ­¥ï¼‰
          max-active: ${REDIS_POOL_MAX_ACTIVE:64}
          # æœ€å¤§ç©ºé—²è¿æ¥
          max-idle: ${REDIS_POOL_MAX_IDLE:32}
          # æœ€å°ç©ºé—²è¿æ¥
          min-idle: ${REDIS_POOL_MIN_IDLE:8}
          # å–è¿æ¥æœ€å¤§ç­‰å¾…æ—¶é—´
          max-wait: ${REDIS_POOL_MAX_WAIT:5s}

  # Spring Cache é…ç½®
  cache:
    type: redis
    redis:
      # é»˜è®¤ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼ˆ30åˆ†é’Ÿï¼‰
      time-to-live: ${CACHE_DEFAULT_TTL:30m}
      cache-null-values: false
      use-key-prefix: true

  # ========== æ¶ˆæ¯é˜Ÿåˆ—é…ç½® (å¯é€‰) ==========
  # rabbitmq:
  #   host: ${MQ_HOST:localhost}
  #   port: ${MQ_PORT:5672}
  #   username: ${MQ_USERNAME:guest}
  #   password: ${MQ_PASSWORD:guest}
  #   virtual-host: ${MQ_VHOST:/}
  #   connection-timeout: 5000ms

  # =================== å›½é™…åŒ–é…ç½® ===================
  messages:
    basename: messages/errors
    encoding: UTF-8
    # ç”Ÿäº§ï¼šç¼“å­˜ 1 å°æ—¶ï¼›å¼€å‘å¯è¦†ç›–ä¸º 0s ä»¥ä¾¿çƒ­æ›´æ–°
    cache-duration: PT1H
    # ä¸å›é€€åˆ°ç³»ç»Ÿ Localeï¼Œé¿å…ç¯å¢ƒå·®å¼‚å¸¦æ¥çš„æ–‡æ¡ˆå¼‚å¸¸
    fallback-to-system-locale: false
    # å§‹ç»ˆæŒ‰ MessageFormat è§£æï¼Œå ä½ç¬¦éœ€è¦ç”¨ {0}ã€{1}ï¼›æ³¨æ„å•å¼•å·éœ€å†™æˆ ''
    always-use-message-format: true

  # =================== é‚®ä»¶æœåŠ¡åŸºç¡€é…ç½® ===================
  mail:
    # SMTP ä¸»æœºï¼ˆä¼ä¸šé‚®ç®±ï¼‰
    host: ${MAIL_HOST:smtp.exmail.qq.com}
    # 587 = æ˜æ–‡è¿æ¥ + STARTTLS å‡çº§
    port: ${MAIL_PORT:587}
    # å‘ä¿¡è´¦å·ï¼ˆå»ºè®®ä¸“ç”¨è´¦å·ï¼‰
    username: ${MAIL_USERNAME:}
    # å‘ä¿¡å¯†ç /æˆæƒç ï¼ˆä¸è¦ç¡¬ç¼–ç ï¼‰
    password: ${MAIL_PASSWORD:}
    # åè®®ï¼šsmtpï¼ˆSTARTTLS åœºæ™¯ï¼‰
    protocol: smtp
    # é»˜è®¤ç¼–ç 
    default-encoding: UTF-8
    # å¯åŠ¨æ—¶æ˜¯å¦å°è¯•è¿æ¥ï¼ˆprod ä¸€èˆ¬ falseï¼›è¿ç»´éœ€è¦å¯è®¾ trueï¼‰
    test-connection: false
    properties:
      mail:
        smtp:
          # å¯ç”¨ SMTP èº«ä»½è®¤è¯
          auth: true
          # ===== STARTTLSï¼ˆ587 ç«¯å£ï¼‰=====
          starttls:
            # å…è®¸ STARTTLS
            enable: true
            # è¦æ±‚å¿…é¡»ä½¿ç”¨ TLSï¼Œå¦åˆ™å¤±è´¥ï¼ˆæ›´å®‰å…¨ï¼‰
            required: true
          # ===== TLS/SSL ç»†åŒ–é…ç½® =====
          ssl:
            # é™å®šåè®®ç‰ˆæœ¬ï¼Œé¿å…é™çº§
            protocols: "TLSv1.2 TLSv1.3"
            # æ ¡éªŒè¯ä¹¦ä¸»æœºåï¼Œé˜²æ­¢ä¸­é—´äºº
            checkserveridentity: true
            # å¦‚é‡ä¿¡ä»»é“¾å¼‚å¸¸å¯ä¸´æ—¶æŒ‡å®šï¼ˆæ›´æ¨èå®‰è£…æ­£ç¡® CAï¼‰
            # trust: "smtp.exmail.qq.com"
          # ===== è¿æ¥/è¯»å†™è¶…æ—¶ï¼ˆæ¯«ç§’ï¼‰=====
          # è¿æ¥è¶…æ—¶ï¼ˆå»ºè®® 10sï¼‰
          connectiontimeout: ${MAIL_CONNECTION_TIMEOUT:10000}
          # è¯»å–è¶…æ—¶ï¼ˆå»ºè®® 15sï¼‰
          timeout: ${MAIL_TIMEOUT:15000}
          # å†™å…¥è¶…æ—¶ï¼ˆå»ºè®® 15sï¼‰
          writetimeout: ${MAIL_WRITE_TIMEOUT:15000}
          # ===== è¿æ¥æ± /æ€§èƒ½ï¼ˆå¤§æ‰¹é‡å‘é€å¯å¯ç”¨ï¼‰=====
          # æ‰¹é‡å‘é€å¯æ”¹ trueï¼Œå¤ç”¨è¿æ¥å‡å°‘æ¡æ‰‹
          pool: false
          # è¿æ¥æ± å¤§å°ï¼ˆæ ¹æ®å¹¶å‘é‡ä¸æœåŠ¡ç«¯é™æµè®¾ç½®ï¼‰
          # pool.size: 5
          # å…è®¸ 8bit ä¼ è¾“ï¼ˆå¤šæ•°ç°ä»£æœåŠ¡å™¨å…¼å®¹ï¼‰
          allow8bitmime: true

  # =================== AIæœåŠ¡é»˜è®¤é…ç½® ===================
  ai:
    model:
      # ç¦ç”¨å®˜æ–¹Chatè‡ªåŠ¨è£…é…
      chat: none
      # ç¦ç”¨é»˜è®¤æ–‡æœ¬å‘é‡åŒ–æ¨¡å‹
      embedding: none
      # ç¦ç”¨é»˜è®¤æ–‡ç”Ÿå›¾æ¨¡å‹
      image: none
      # ç¦ç”¨é»˜è®¤è¯­éŸ³æ¨¡å‹
      audio:
        speech: none
  autoconfigure:
    exclude:
      # â€”â€” Alibaba DashScope
      - com.alibaba.cloud.ai.autoconfigure.dashscope.DashScopeAgentAutoConfiguration
      - com.alibaba.cloud.ai.autoconfigure.dashscope.DashScopeAutoConfiguration
        
      # â€”â€” OpenAIï¼ˆå®˜æ–¹ Spring AIï¼‰æ¨¡å—
      - org.springframework.ai.model.openai.autoconfigure.OpenAiAudioTranscriptionAutoConfiguration  # ASR
      - org.springframework.ai.model.openai.autoconfigure.OpenAiModerationAutoConfiguration          # å®¡æ ¸
      - org.springframework.ai.model.openai.autoconfigure.OpenAiImageAutoConfiguration               # å›¾åƒ
      - org.springframework.ai.model.openai.autoconfigure.OpenAiAudioSpeechAutoConfiguration         # TTS

# =================== æœåŠ¡å™¨é…ç½® ===================
server:
  # æœåŠ¡ç«¯å£ï¼ˆå¯ç”¨ç¯å¢ƒå˜é‡è¦†ç›–ï¼‰
  port: ${SERVER_PORT:8080}
  servlet:
    # åº”ç”¨ä¸Šä¸‹æ–‡è·¯å¾„ï¼Œé»˜è®¤æ ¹(/)
    context-path: ${SERVER_CONTEXT_PATH:}
    encoding:
      # ç»Ÿä¸€è¯·æ±‚/å“åº”ç¼–ç 
      charset: UTF-8
      # æ— è®ºè¯·æ±‚å¤´å¦‚ä½•éƒ½å¼ºåˆ¶ä½¿ç”¨ UTF-8
      force: true

  # å¯ç”¨å“åº”å‹ç¼©ï¼ˆGZIPï¼‰ï¼Œä»…å¯¹æ–‡æœ¬ç±» MIME ç”Ÿæ•ˆ
  compression:
    enabled: true
    mime-types: >-
      text/html,text/css,text/plain,
      application/javascript,application/json,
      application/xml,text/xml,
      application/x-yaml,
      application/problem+json,
      application/ndjson
    # å°äº 1KB çš„å“åº”ä¸å‹ç¼©ï¼Œé¿å… CPU å¼€é”€
    min-response-size: 1024

  # é”™è¯¯é¡µé¢ä¸é”™è¯¯ä¿¡æ¯å±•ç¤ºç­–ç•¥
  error:
    whitelabel:
      # ç¦ç”¨é»˜è®¤ç™½æ ‡é”™è¯¯é¡µï¼ˆä½¿ç”¨è‡ªå®šä¹‰é”™è¯¯é¡µæˆ–ç»Ÿä¸€å¼‚å¸¸å¤„ç†ï¼‰
      enabled: false
    # ç”Ÿäº§å®‰å…¨ï¼šä¸è¿”å›å †æ ˆ
    include-stacktrace: never
    # â›” å»ºè®®ç”Ÿäº§æ”¹ä¸º never æˆ– on_paramï¼ˆè§ä¸‹æ–¹æŒ‰ç¯å¢ƒè¦†ç›–ï¼‰
    include-message: always

  # HTTP/2ï¼ˆåœ¨ HTTPS/TLS åœºæ™¯æ˜¾è‘—æå‡æ€§èƒ½ï¼‰
  http2:
    enabled: true

  # åå‘ä»£ç†/è´Ÿè½½å‡è¡¡åœºæ™¯éœ€è¦æ­£ç¡®å¤„ç† X-Forwarded-* å¤´
  forward-headers-strategy: native
  # spring boot 3.4+ æ”¯æŒï¼šframework/nativeï¼›native èµ°å®¹å™¨å®ç°ï¼Œä¾‹å¦‚ tomcat RemoteIpValve

  # Tomcat èµ„æºä¸æŠ¥æ–‡é™åˆ¶ï¼ˆæŒ‰å‹æµ‹ç»“æœè°ƒæ•´ï¼‰
  tomcat:
    threads:
      # æœ€å¤§å·¥ä½œçº¿ç¨‹ï¼ˆå¹¶å‘é‡å¤§å¯é€‚å½“ä¸Šè°ƒï¼‰
      max: 200
      min-spare: 20
    # ç­‰å¾…é˜Ÿåˆ—é•¿åº¦
    accept-count: 100
    # è¡¨å•ä¸Šä¼ å¤§å°é™åˆ¶ï¼ˆé˜²å¾¡æ€§ï¼‰
    max-http-form-post-size: 2MB
    # HTTP å¤´å¤§å°é™åˆ¶ï¼ˆé˜²å¾¡æ€§ï¼‰
    max-http-response-header-size: 16KB
    # è¿æ¥è¢«å…³é—­å‰åå…¥çš„æœ€å¤§è¯·æ±‚ä½“ï¼ˆé˜²å¾¡æ€§ï¼‰
    max-swallow-size: 2MB

# =================== ç®¡ç†ç«¯ç‚¹é…ç½® ===================
management:
  server:
    # ç®¡ç†ç«¯å£ï¼ˆå»ºè®®ä»…å†…ç½‘æˆ–åŠ é‰´æƒï¼‰
    port: ${MGMT_PORT:8081}
  endpoints:
    web:
      # ç»Ÿä¸€å‰ç¼€
      base-path: /actuator
      exposure:
        # æš´éœ²å¥åº·æ£€æŸ¥ã€æŒ‡æ ‡ç­‰ç›‘æ§ç«¯ç‚¹
        include: health,info,metrics,scheduledtasks,prometheus,loggers,env,configprops
  endpoint:
    health:
      # å¥åº·ç»†èŠ‚ä»…æˆæƒå¯è§
      show-details: when-authorized
      # æ€»è§ˆæ˜¾ç¤ºç»„ä»¶ï¼ˆä¸ä¸Šè¡Œé…åˆæ›´å®‰å…¨ï¼‰
      show-components: always
      # å¯ç”¨ liveness/readinessï¼ˆK8s å‹å¥½ï¼‰
      probes:
        enabled: true
    metrics:
      # ä»…åœ¨å—æ§ç½‘ç»œ/é‰´æƒä¸‹ä½¿ç”¨ï¼›å¦åˆ™å»ºè®®å—é™
      access: unrestricted
    prometheus:
      # åŒä¸Š
      access: unrestricted
  prometheus:
    metrics:
      export:
        # æš´éœ² /actuator/prometheus
        enabled: true
  metrics:
    distribution:
      percentiles-histogram:
        # ä¸º HTTP è¯·æ±‚å¼€å¯ç›´æ–¹å›¾ï¼ˆP95/P99ï¼‰
        "[http.server.requests]": true
        # è‡ªå®šä¹‰è®¡æ—¶å™¨ç›´æ–¹å›¾
        "[baseai.chat.response.time]": true
        "[baseai.kb.search.time]": true
      # ä¸ºå…³é”®æ¥å£å®šä¹‰ SLO åˆ†æ¡¶ï¼ˆPromQL å‹å¥½ï¼‰
      slo:
        "[http.server.requests]": 50ms,100ms,200ms,300ms,500ms,1s,2s,5s
    tags:
      # ç»Ÿä¸€æ ‡ç­¾
      application: ${spring.application.name}
      # ç¯å¢ƒæ ‡ç­¾ï¼ˆdev/qa/prodï¼‰
      environment: ${spring.profiles.active}
      # å¯é€‰ï¼šå®ä¾‹æ ‡è¯†ï¼ˆK8s å»ºè®®ç”¨ HOSTNAMEï¼‰
      # instanceId: ${HOSTNAME:${random.uuid}}
  health:
    db:
      enabled: true
    redis:
      enabled: true
    diskspace:
      enabled: true

# =================== æ—¥å¿—é…ç½® ===================
logging:
  level:
    # å…¨å±€æ—¥å¿—çº§åˆ«ï¼ˆé»˜è®¤ INFOï¼‰
    root: ${LOG_LEVEL_ROOT:INFO}
    # åº”ç”¨ä¸»åŒ…æ—¥å¿—çº§åˆ«ï¼ˆé»˜è®¤ DEBUGï¼‰
    com.cloud.baseai: ${LOG_LEVEL_APP:DEBUG}
    # Spring Web è¯·æ±‚æ—¥å¿—
    org.springframework.web: ${LOG_LEVEL_SPRING_WEB:INFO}
    # Spring Security æ—¥å¿—
    org.springframework.security: ${LOG_LEVEL_SECURITY:INFO}
    # Hibernate SQL è¾“å‡ºæ—¥å¿—ï¼ˆä»… WARNï¼‰
    org.hibernate.SQL: ${LOG_LEVEL_SQL:WARN}
    # Hibernate å‚æ•°ç»‘å®šæ—¥å¿—ï¼ˆä»… WARNï¼‰
    org.hibernate.type.descriptor.sql.BasicBinder: WARN
    # Hibernate è¿æ¥æ± æ—¥å¿—
    org.hibernate.orm.connections.pooling: WARN
    # Spring Cache ç›¸å…³æ—¥å¿—
    org.springframework.cache: DEBUG
    # é˜¿é‡Œäº‘ AI ç›¸å…³æ—¥å¿—
    com.alibaba.cloud.ai: INFO
    # Spring AI ç›¸å…³æ—¥å¿—
    org.springframework.ai: INFO
    # Spring è°ƒåº¦ï¼ˆå®šæ—¶ä»»åŠ¡ï¼‰æ—¥å¿—
    org.springframework.scheduling: INFO
  pattern:
    console: "%clr(%d{yyyy-MM-dd HH:mm:ss.SSS}){faint} %clr(${LOG_LEVEL_PATTERN:-%5p}) %clr(${PID:- }){magenta} %clr(---){faint} %clr([%15.15t]){faint} %clr(%-40.40logger{39}){cyan} %clr(:){faint} %m%n${LOG_EXCEPTION_CONVERSION_WORD:-%wEx}"
    # æ–‡ä»¶æ—¥å¿—æ ¼å¼ï¼šæ—¶é—´æˆ³ + çº¿ç¨‹ + çº§åˆ«ï¼ˆå·¦å¯¹é½5ä½ï¼‰+ æœ€å¤š50å­—ç¬¦ç±»å + æ¶ˆæ¯
    file: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n"
  file:
    # æ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼ˆé»˜è®¤ logs/baseai-cloud.logï¼‰
    name: ${LOG_FILE:logs/baseai-cloud.log}
  logback:
    rollingpolicy:
      # å•æ–‡ä»¶æœ€å¤§ 100MBï¼Œè¶…è¿‡ååˆ‡åˆ†
      max-file-size: ${LOG_FILE_MAX_SIZE:100MB}
      # ä¿ç•™æœ€è¿‘ 30 å¤©çš„æ—¥å¿—å½’æ¡£
      max-history: ${LOG_FILE_MAX_HISTORY:30}
      # æ‰€æœ‰å½’æ¡£æ€»å¤§å°ä¸Šé™ 1GBï¼Œè¶…è¿‡åˆ™åˆ é™¤æœ€æ—§
      total-size-cap: ${LOG_FILE_TOTAL_SIZE:1GB}

# =================== API æ–‡æ¡£é…ç½® ===================
springdoc:
  api-docs:
    enabled: ${SPRINGDOC_ENABLED:true}
    path: /v3/api-docs
  swagger-ui:
    enabled: ${SPRINGDOC_ENABLED:true}
    path: /swagger-ui.html
    disable-swagger-default-url: true
    # è®¾ç½®é»˜è®¤æ˜¾ç¤ºæœ€é‡è¦çš„APIåˆ†ç»„
    urls-primary-name: 'kb-api'
    # è®¾ç½®æ“ä½œå’Œæ ‡ç­¾çš„æ’åº
    operations-sorter: alpha
    tags-sorter: none
    # è®¾ç½®é»˜è®¤çš„æ¨¡å‹æ¸²æŸ“æ·±åº¦
    default-model-expand-depth: 2
    # è®¾ç½®é»˜è®¤çš„æ¨¡å‹ç¤ºä¾‹å±•å¼€æ·±åº¦
    default-models-expand-depth: 1
    # æ˜¾ç¤ºè¯·æ±‚æŒç»­æ—¶é—´
    display-request-duration: true
  show-actuator: false
  group-configs:
    # æ ¸å¿ƒä¸šåŠ¡API - æœ€å¸¸ç”¨çš„åŠŸèƒ½
    - group: 'kb-api'
      display-name: 'ğŸ“š çŸ¥è¯†åº“API'
      paths-to-match: '/api/v1/kb/**'
    - group: 'chat-api'
      display-name: 'ğŸ’¬ å¯¹è¯API'
      paths-to-match: '/api/v1/chat/**'

    # ç”¨æˆ·ç›¸å…³API
    - group: 'auth-api'
      display-name: 'ğŸ” è®¤è¯æˆæƒAPI'
      paths-to-match: '/api/v1/auth/**'
    - group: 'user-api'
      display-name: 'ğŸ‘¥ ç”¨æˆ·ç®¡ç†API'
      paths-to-match: '/api/v1/users/**'

    # æ‰©å±•åŠŸèƒ½API
    - group: 'flow-api'
      display-name: 'ğŸ”„ æµç¨‹ç¼–æ’API'
      paths-to-match: '/api/v1/flows/**'
    - group: 'misc-api'
      display-name: 'ğŸ”§ å…¶ä»–API'
      paths-to-match:
        - '/api/v1/misc/**'
        - '/api/v1/mcp/**'

    # ç®¡ç†åŠŸèƒ½API - ä½¿ç”¨é¢‘ç‡è¾ƒä½
    - group: 'system-api'
      display-name: 'âš™ï¸ ç³»ç»Ÿç®¡ç†API'
      paths-to-match:
        - '/api/v1/system/**'
        - '/api/v1/audit/**'

  # =================== åº”ç”¨ç‰¹å®šé…ç½® ===================
  # æ³¨æ„ï¼šä»¥ä¸‹é…ç½®ä¸ºåº”ç”¨æ¡†æ¶çº§åˆ«é…ç½®ï¼Œä¸å¯åŠ¨æ€ä¿®æ”¹
baseai:
  # ========== ç³»ç»Ÿå®‰å…¨é…ç½® ==========
  security:
    # JWT ä»¤ç‰Œé…ç½®
    jwt:
      # æ˜¯å¦ä½¿ç”¨RSAåŠ å¯†ï¼ˆæ¨èç”Ÿäº§ç¯å¢ƒä½¿ç”¨ï¼‰
      use-rsa: true
      # RSAå¯†é’¥å¯¹ï¼ˆBase64ç¼–ç ï¼‰
      # ç”Ÿäº§ç¯å¢ƒä¸­è¿™äº›å¯†é’¥åº”è¯¥ä»å¤–éƒ¨å¯†é’¥ç®¡ç†æœåŠ¡æˆ–ç¯å¢ƒå˜é‡ä¸­åŠ è½½
      rsa-private-key: ${JWT_RSA_PRIVATE_KEY:MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCZlvFsbXNbePtnjMBQXcX1z52QacU1nB0A4RCftC7nKM6ZVhaM3A5zEIXkGJoVfr2QgBArRJWTGAy/a3BF8C0Ndk/v3AuKkkhQRBPa3kShOc+MvrHZ/TM3qmpUpsYijlnwVSAai4rJFfRqQvyU+4y3i/nzJ7218rZolF5j0C2t4MB7KmvZMlyKB0TuJtHncuvDSViYHdw7EEKrzjxhAy/XfEKtShOicg1Gy5tSgUnNJW+EKKpUEFfx3R4ICiYTjYcgoll6H1deW0fCGeAFerRM+1ECmaIC66608rPhPQnRYvMjN8+JAUAlQNd8ichcdeVerluWg3EgrHHRa+C1fl+vAgMBAAECggEAAKoxGM2NihHpI385Q+GsB5oIXwHNQdEAYV9yYIh5kjRnGi3Pt1puQitN/jzo5/M0/hY30kmJNjWULQSG1I+cMsihhno8gQX11rNXFwOldcGMkcM+m2xFxL8uEB3qr+7XCx3FkKfZj468NkA+Y7Q6sCRZaJfyPPNo+OU1KSbL21nIefcBZvsCGdcoCuA6XB2nl7svw6VXV/+ZYNfZfHtsSvMDskod1BcWTsMvsO/h9N6ayIBwnNcoYRH4/Fg33l/vc06o9GiBMTTkvEkeCpCipW8IHIz5rl1aDjJxqrihDUGegZ5md4i5A7L4HOVjDHIedJEwoTamzwIRgKP/ZCGj9QKBgQDYC8sOvdxO2Pr+TWMqK+Ax0hCpR/YMgMJnzSaeehFbGOgL1uDVyrfHSMiFS1+o0Q88DdwhdFWOfcHMZibBaCDyu+XZvUqgVl+vuDmRE0bADuoiSi2U0UgjM48cosZ7jPWUMlepDMD8YjFnk+JyZUX+GhAcv6WFiQhw96UNCgt34wKBgQC1/krVb3nrDs1DmXyMUqN424X0E3bj4qWVCTw4tzlToB+JItzAzSkL+VHMlI++FhiVrbrtROdP+e8MjHGgYqm0efoGv+S1fKNkpoCKeZ8S47dL0OUxirzwNzr/brcZWI0eBCZiKJP2Mkl+10uTe3SGU7jm6ZBsasM1HA10IkbKxQKBgHHAM9e9K2PwZqbChDXOCCrzGYantur6WGFi6LSEPOMkB/lD1/l41K5+qeVUvDcca9MI0SBkKi/uEr3WAw3OD5r+R5UPT12AXL0eWGEELzosICaRu9IhJsQx/2XqZmri2uJ+Zx1A89Nut+h7Or1UiTey7UzVswbOEb25BhQJd+RVAoGAG0txI8OdUGCe7mWFpXH7bHPYCjwlF5Z1aP3Cl2r7YQxhzmp5Gz1py47v8rPRPxwHQeOVZmJwIrGEZahmnjxN4XBtzDdZcNKpmr3SB3KoJegbJHbG+QAqyAgwhACx205Jk9fhfdVCI6l1Fl3pysu4NTE3SQJ8k5YLgtqbNfCyF1UCgYEAkXQ5j+pSJxprgaFrvXHpFOFJ+d/6gaevTQn/n05kjBEUVxZw04RVYKN1kjo3gQGmQVrWhDXrjwNMXmD5QfUNVzPbRtdbkY+rP7ojezN0VIza9fu+GRhWGWDyUzzYcd/u3KWET4z6FC88CyYodadVF3td5R08IdeVqPIhuwwmQVs=}
      rsa-public-key: ${JWT_RSA_PUBLIC_KEY:MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAmZbxbG1zW3j7Z4zAUF3F9c+dkGnFNZwdAOEQn7Qu5yjOmVYWjNwOcxCF5BiaFX69kIAQK0SVkxgMv2twRfAtDXZP79wLipJIUEQT2t5EoTnPjL6x2f0zN6pqVKbGIo5Z8FUgGouKyRX0akL8lPuMt4v58ye9tfK2aJReY9AtreDAeypr2TJcigdE7ibR53Lrw0lYmB3cOxBCq848YQMv13xCrUoTonINRsubUoFJzSVvhCiqVBBX8d0eCAomE42HIKJZeh9XXltHwhngBXq0TPtRApmiAuuutPKz4T0J0WLzIzfPiQFAJUDXfInIXHXlXq5bloNxIKxx0WvgtX5frwIDAQAB}
      # HMACå¯†é’¥ï¼ˆå½“use-rsa=falseæ—¶ä½¿ç”¨ï¼‰
      secret: ${JWT_SECRET:very-long-secret-key-at-least-256-bits-for-production-environment-security}

      # ä»¤ç‰Œè¿‡æœŸæ—¶é—´é…ç½®
      # è®¿é—®ä»¤ç‰Œæœ‰æ•ˆæœŸï¼ˆ1å°æ—¶ï¼‰
      access-token-expiration: ${JWT_ACCESS_TOKEN_EXPIRATION:3600000}
      # åˆ·æ–°ä»¤ç‰Œæœ‰æ•ˆæœŸï¼ˆ7å¤©ï¼‰
      refresh-token-expiration: ${JWT_REFRESH_TOKEN_EXPIRATION:604800000}
      # JWT å‘è¡Œè€…æ ‡è¯†
      issuer: ${JWT_ISSUER:baseai-cloud-system}

      # å®‰å…¨ç‰¹æ€§å¼€å…³
      # æ˜¯å¦å¯ç”¨ä»¤ç‰Œé»‘åå•
      enable-blacklist: true
      # æ˜¯å¦å¯ç”¨è®¾å¤‡æŒ‡çº¹éªŒè¯
      enable-device-fingerprint: true
      # è‡ªåŠ¨åˆ·æ–°é˜ˆå€¼ï¼ˆç§’ï¼‰
      auto-refresh-threshold: 1800

    # è·¨åŸŸèµ„æºå…±äº«é…ç½®
    cors:
      enabled: true
      allowed-origins: ${CORS_ALLOWED_ORIGINS:http://localhost:3000,http://localhost:8080,https://*.baseai.com}
      allowed-methods: ${CORS_ALLOWED_METHODS:GET,POST,PUT,DELETE,OPTIONS,PATCH}
      allowed-headers: ${CORS_ALLOWED_HEADERS:Authorization,Content-Type,X-Requested-With,X-Device-Fingerprint}
      exposed-headers: ${CORS_EXPOSED_HEADERS:Authorization,X-Total-Count,X-Page-Number,X-Page-Size}
      allow-credentials: ${CORS_ALLOW_CREDENTIALS:true}
      max-age: ${CORS_MAX_AGE:3600}

    # å¯†ç ç­–ç•¥é…ç½®
    password:
      # æœ€å°é•¿åº¦è¦æ±‚
      min-length: ${PASSWORD_MIN_LENGTH:8}
      # æœ€å¤§é•¿åº¦é™åˆ¶
      max-length: ${PASSWORD_MAX_LENGTH:128}
      # æ˜¯å¦è¦æ±‚åŒ…å«å¤§å†™å­—æ¯
      require-uppercase: ${PASSWORD_REQUIRE_UPPERCASE:true}
      # æ˜¯å¦è¦æ±‚åŒ…å«å°å†™å­—æ¯
      require-lowercase: ${PASSWORD_REQUIRE_LOWERCASE:true}
      # æ˜¯å¦è¦æ±‚åŒ…å«æ•°å­—
      require-numbers: ${PASSWORD_REQUIRE_NUMBERS:true}
      # æ˜¯å¦è¦æ±‚åŒ…å«ç‰¹æ®Šå­—ç¬¦
      require-special-chars: ${PASSWORD_REQUIRE_SPECIAL:true}
      # å…è®¸çš„ç‰¹æ®Šå­—ç¬¦é›†åˆ
      special-chars: "!@#$%^&*()_+-=[]{}|;:,.<>?"
      # å¯†ç å†å²è®°å½•æ•°é‡ï¼Œé˜²æ­¢é‡å¤ä½¿ç”¨è¿‘æœŸå¯†ç 
      history-count: ${PASSWORD_HISTORY_COUNT:5}
      # å¯†ç æœ€å¤§ä½¿ç”¨å¤©æ•°ï¼Œè¶…è¿‡åå¼ºåˆ¶ä¿®æ”¹
      max-age-days: ${PASSWORD_MAX_AGE:90}
      # ç™»å½•å¤±è´¥é”å®šé˜ˆå€¼
      lockout-threshold: ${PASSWORD_LOCKOUT_THRESHOLD:5}
      # è´¦æˆ·é”å®šæ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰
      lockout-duration-minutes: ${PASSWORD_LOCKOUT_DURATION:30}
      # å¯ç”¨å¯†ç å¤æ‚åº¦æ£€æŸ¥
      enable-complexity-check: true
      # å¯ç”¨å¼±å¯†ç æ£€æµ‹
      enable-weak-password-check: true
      # å¯ç”¨å¯†ç æ³„éœ²æ£€æŸ¥
      enable-breach-check: true

    # è®¤è¯ç›¸å…³é…ç½®
    auth:
      # æ˜¯å¦å…è®¸å¤šè®¾å¤‡ç™»å½•
      enable-multi-device: true
      # å•ç”¨æˆ·æœ€å¤§åŒæ—¶ç™»å½•è®¾å¤‡æ•°
      max-devices-per-user: 5
      # æ˜¯å¦å¯ç”¨IPåœ°å€éªŒè¯
      enable-ip-validation: false
      # å…è®¸çš„IPåœ°å€åˆ—è¡¨
      allowed-ips: ""
      # ä¼šè¯è¶…æ—¶æ—¶é—´
      session-timeout-minutes: 120
      # æ˜¯å¦å¯ç”¨è®°ä½æˆ‘åŠŸèƒ½
      enable-remember-me: true
      # è®°ä½æˆ‘æœ‰æ•ˆæœŸ
      remember-me-days: 30
      # æ˜¯å¦å¯ç”¨éªŒè¯ç 
      enable-captcha: false
      # éªŒè¯ç è§¦å‘é˜ˆå€¼
      captcha-threshold: 3
      # æ˜¯å¦å¯ç”¨äºŒæ¬¡éªŒè¯
      enable-two-factor-auth: false
      # äºŒæ¬¡éªŒè¯ä»£ç æœ‰æ•ˆæœŸ
      two-factor-code-expiration: 300
      # æ˜¯å¦å¯ç”¨ç™»å½•å¼‚å¸¸æ£€æµ‹
      enable-anomaly-detection: true
      # æ˜¯å¦è®°å½•ç™»å½•å†å²
      enable-login-history: true
      # ç™»å½•å†å²ä¿ç•™å¤©æ•°
      login-history-retention-days: 90

  # ========== é€Ÿç‡é™åˆ¶é…ç½® ==========
  rate-limit:
    # å…¨å±€APIé™åˆ¶
    global:
      # æ¯åˆ†é’Ÿæœ€å¤§è¯·æ±‚æ•°
      requests-per-minute: ${RATE_LIMIT_GLOBAL_PER_MINUTE:100}
      # æ¯å°æ—¶æœ€å¤§è¯·æ±‚æ•°
      requests-per-hour: ${RATE_LIMIT_GLOBAL_PER_HOUR:1000}
      # æ¯å¤©æœ€å¤§è¯·æ±‚æ•°
      requests-per-day: ${RATE_LIMIT_GLOBAL_PER_DAY:10000}
      # æœ€å¤§å¹¶å‘è¯·æ±‚æ•°
      concurrent-requests: ${RATE_LIMIT_CONCURRENT:20}
      # æ˜¯å¦å¯ç”¨çªå‘ä¿æŠ¤
      enable-burst-protection: ${RATE_LIMIT_BURST_ENABLE:true}
      # çªå‘å€æ•°ï¼Œå…è®¸çŸ­æ—¶é—´å†…è¶…è¿‡æ­£å¸¸é™åˆ¶
      burst-multiplier: ${RATE_LIMIT_BURST_MULTIPLIER:2.0}

    # ç”¨æˆ·çº§åˆ«é™åˆ¶
    user:
      # å…è´¹ç”¨æˆ·é™åˆ¶
      free-tier:
        requests-per-day: ${RATE_LIMIT_FREE_DAILY:100}
        chat-messages-per-hour: ${RATE_LIMIT_FREE_CHAT_HOURLY:20}
        document-uploads-per-day: ${RATE_LIMIT_FREE_UPLOAD_DAILY:10}
      # é«˜çº§ç”¨æˆ·é™åˆ¶
      premium-tier:
        requests-per-day: ${RATE_LIMIT_PREMIUM_DAILY:5000}
        chat-messages-per-hour: ${RATE_LIMIT_PREMIUM_CHAT_HOURLY:200}
        document-uploads-per-day: ${RATE_LIMIT_PREMIUM_UPLOAD_DAILY:100}
      # ä¼ä¸šç”¨æˆ·é™åˆ¶
      enterprise-tier:
        requests-per-day: ${RATE_LIMIT_ENTERPRISE_DAILY:50000}
        chat-messages-per-hour: ${RATE_LIMIT_ENTERPRISE_CHAT_HOURLY:2000}
        document-uploads-per-day: ${RATE_LIMIT_ENTERPRISE_UPLOAD_DAILY:1000}

  # ========== çŸ¥è¯†åº“æ¨¡å—é…ç½® ==========
  knowledge-base:
    # æ–‡æ¡£å¤„ç†é…ç½®
    document:
      # å•ä¸ªæ–‡æ¡£æœ€å¤§å¤§å°ï¼ˆå­—èŠ‚ï¼‰ï¼Œé»˜è®¤10MB
      max-size-bytes: ${KB_DOC_MAX_SIZE:10485760}
      # æ‰¹é‡å¤„ç†æœ€å¤§æ•°é‡
      max-batch-size: ${KB_DOC_MAX_BATCH:100}
      # æ‰¹é‡å¤„ç†è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
      batch-timeout-seconds: ${KB_DOC_BATCH_TIMEOUT:300}
      # å¤„ç†å¤±è´¥é‡è¯•æ¬¡æ•°
      retry-attempts: ${KB_DOC_RETRY_ATTEMPTS:3}
      # æ”¯æŒçš„æ–‡ä»¶æ ¼å¼
      supported-formats:
        - pdf
        - txt
        - md
        - docx
        - doc
        - rtf
      # æ”¯æŒçš„MIMEç±»å‹
      supported-mime-types:
        - text/plain
        - text/markdown
        - application/pdf
        - application/msword
        - application/vnd.openxmlformats-officedocument.wordprocessingml.document

    # æ–‡æ¡£åˆ†å—é…ç½®
    chunking:
      # é»˜è®¤åˆ†å—å¤§å°ï¼ˆå­—ç¬¦æ•°ï¼‰
      default-chunk-size: ${KB_CHUNK_SIZE:1000}
      # åˆ†å—é‡å å¤§å°ï¼ˆå­—ç¬¦æ•°ï¼‰ï¼Œä¿è¯è¯­ä¹‰è¿ç»­æ€§
      chunk-overlap: ${KB_CHUNK_OVERLAP:200}
      # æœ€å°åˆ†å—å¤§å°ï¼Œé¿å…è¿‡å°çš„åˆ†å—
      min-chunk-size: ${KB_CHUNK_MIN_SIZE:100}
      # æœ€å¤§åˆ†å—å¤§å°ï¼Œé¿å…è¿‡å¤§çš„åˆ†å—å½±å“æ£€ç´¢ç²¾åº¦
      max-chunk-size: ${KB_CHUNK_MAX_SIZE:4000}
      # æ˜¯å¦å¯ç”¨è‡ªé€‚åº”åˆ†å—ï¼Œæ ¹æ®å†…å®¹ç±»å‹è°ƒæ•´ç­–ç•¥
      adaptive-chunking: ${KB_ADAPTIVE_CHUNKING:true}
      # æŒ‰å†…å®¹ç±»å‹çš„åˆ†å—ç­–ç•¥
      content-type-strategies:
        markdown:
          chunk-size: 800
          overlap: 150
        pdf:
          chunk-size: 1200
          overlap: 250
        text:
          chunk-size: 1000
          overlap: 200

    # å‘é‡åµŒå…¥é…ç½®
    embedding:
      # é»˜è®¤åµŒå…¥æ¨¡å‹
      default-model: ${KB_EMBEDDING_MODEL:text-embedding-3-small}
      # å‘é‡ç»´åº¦
      dimension: ${KB_EMBEDDING_DIMENSION:1536}
      # æ‰¹é‡å¤„ç†å¤§å°
      batch-size: ${KB_EMBEDDING_BATCH_SIZE:50}
      # APIè°ƒç”¨è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
      timeout-seconds: ${KB_EMBEDDING_TIMEOUT:30}
      # æ˜¯å¦æ ‡å‡†åŒ–å‘é‡
      normalize: ${KB_EMBEDDING_NORMALIZE:true}
      # å¤‡ç”¨æ¨¡å‹åˆ—è¡¨ï¼Œå½“ä¸»æ¨¡å‹ä¸å¯ç”¨æ—¶ä½¿ç”¨
      fallback-models:
        - text-embedding-ada-002
        - text-embedding-v2
      # æ¨¡å‹èƒ½åŠ›é…ç½®ï¼Œç”¨äºæ™ºèƒ½é€‰æ‹©æ¨¡å‹
      model-capabilities:
        text-embedding-3-small:
          max-tokens: 8191
          dimension: 1536
          cost-per-token: 0.00002
        text-embedding-3-large:
          max-tokens: 8191
          dimension: 3072
          cost-per-token: 0.00013
        text-embedding-ada-002:
          max-tokens: 8191
          dimension: 1536
          cost-per-token: 0.0001
        text-embedding-v2:
          max-tokens: 2048
          dimension: 1536
          cost-per-token: 0.0007

    # å‘é‡æœç´¢é…ç½®
    search:
      # é»˜è®¤è¿”å›ç»“æœæ•°é‡
      default-top-k: ${KB_SEARCH_TOP_K:10}
      # æœ€å¤§è¿”å›ç»“æœæ•°é‡
      max-top-k: ${KB_SEARCH_MAX_TOP_K:100}
      # é»˜è®¤ç›¸ä¼¼åº¦é˜ˆå€¼
      default-threshold: ${KB_SEARCH_THRESHOLD:0.7}
      # æœ€å°ç›¸ä¼¼åº¦é˜ˆå€¼
      min-threshold: ${KB_SEARCH_MIN_THRESHOLD:0.0}
      # æ˜¯å¦å¯ç”¨é‡æ’åºï¼Œæé«˜æœç´¢è´¨é‡
      enable-rerank: ${KB_SEARCH_ENABLE_RERANK:true}
      # é‡æ’åºå€™é€‰æ•°é‡
      rerank-top-k: ${KB_SEARCH_RERANK_TOP_K:20}
      # æœç´¢ç»“æœç¼“å­˜æ—¶é—´ï¼ˆç§’ï¼‰
      result-cache-ttl-seconds: ${KB_SEARCH_CACHE_TTL:300}
      # é«˜äº®æ˜¾ç¤ºé…ç½®
      highlight:
        enable: ${KB_SEARCH_HIGHLIGHT_ENABLE:true}
        max-highlights: ${KB_SEARCH_HIGHLIGHT_MAX:3}
        highlight-length: ${KB_SEARCH_HIGHLIGHT_LENGTH:100}
        fragment-size: ${KB_SEARCH_FRAGMENT_SIZE:150}

    # æ€§èƒ½ä¼˜åŒ–é…ç½®
    performance:
      # æ•°æ®åº“è¿æ¥æ± å¤§å°
      db-pool-size: ${KB_PERF_DB_POOL:20}
      # å¼‚æ­¥å¤„ç†çº¿ç¨‹æ± å¤§å°
      async-pool-size: ${KB_PERF_ASYNC_POOL:10}
      # æ‰¹é‡å¤„ç†å¤§å°
      batch-process-size: ${KB_PERF_BATCH_SIZE:100}
      # æ˜¯å¦å¯ç”¨æŸ¥è¯¢ç¼“å­˜
      enable-query-cache: ${KB_PERF_QUERY_CACHE:true}
      # æŸ¥è¯¢ç¼“å­˜å¤§å°
      query-cache-size: ${KB_PERF_CACHE_SIZE:1000}
      # æ˜¯å¦å¯ç”¨æ€§èƒ½æŒ‡æ ‡æ”¶é›†
      enable-metrics: ${KB_PERF_METRICS:true}
      # æ…¢æŸ¥è¯¢é˜ˆå€¼ï¼ˆæ¯«ç§’ï¼‰
      slow-query-threshold-ms: ${KB_PERF_SLOW_QUERY:1000}

  # ========== å¯¹è¯ç³»ç»Ÿé…ç½® ==========
  chat:
    # æ¶ˆæ¯çº¦æŸé…ç½®
    message:
      # å•æ¡æ¶ˆæ¯æœ€å¤§é•¿åº¦ï¼ˆå­—ç¬¦æ•°ï¼‰
      max-length: ${CHAT_MSG_MAX_LENGTH:32000}
      # ä¸Šä¸‹æ–‡ä¸­æœ€å¤§æ¶ˆæ¯æ•°é‡
      max-context-messages: ${CHAT_MSG_MAX_CONTEXT:50}
      # ä¸Šä¸‹æ–‡æœ€å¤§ä»¤ç‰Œæ•°
      max-context-tokens: ${CHAT_MSG_MAX_TOKENS:8000}
      # æ˜¯å¦å¯ç”¨æ¶ˆæ¯å†…å®¹éªŒè¯
      enable-validation: ${CHAT_MSG_VALIDATION:true}
      # æ˜¯å¦è‡ªåŠ¨æˆªæ–­è¿‡é•¿æ¶ˆæ¯
      auto-truncate: ${CHAT_MSG_AUTO_TRUNCATE:true}
      # è¢«é˜»æ­¢çš„å†…å®¹æ¨¡å¼åˆ—è¡¨
      blocked-patterns:
        - spam
        - abuse
        - advertisement

    # çŸ¥è¯†æ£€ç´¢é…ç½®
    knowledge-retrieval:
      # æ£€ç´¢ç»“æœæ•°é‡
      top-k: ${CHAT_KB_TOP_K:5}
      # ç›¸ä¼¼åº¦é˜ˆå€¼
      threshold: ${CHAT_KB_THRESHOLD:0.7}
      # æ˜¯å¦å¯ç”¨ä¸Šä¸‹æ–‡å¢å¼º
      enable-context-enrichment: ${CHAT_KB_CONTEXT_ENRICHMENT:true}
      # æœ€å¤§æ£€ç´¢å­—ç¬¦æ•°
      max-retrieved-chars: ${CHAT_KB_MAX_CHARS:4000}
      # æ£€ç´¢è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
      retrieval-timeout-ms: ${CHAT_KB_TIMEOUT:5000}
      # æ˜¯å¦å¯ç”¨å¼•ç”¨åŠŸèƒ½
      enable-citation: ${CHAT_KB_CITATION:true}
      # å¼•ç”¨æ ¼å¼
      citation-format: ${CHAT_KB_CITATION_FORMAT:markdown}

    # AIåŠŸèƒ½é…ç½®
    ai-features:
      # æ˜¯å¦å¯ç”¨è¯­ä¹‰åˆ†æ
      enable-semantic-analysis: ${CHAT_AI_SEMANTIC:true}
      # æ˜¯å¦å¯ç”¨æƒ…æ„Ÿæ£€æµ‹
      enable-sentiment-detection: ${CHAT_AI_SENTIMENT:false}
      # æ˜¯å¦å¯ç”¨è‡ªåŠ¨æ‘˜è¦
      enable-auto-summary: ${CHAT_AI_SUMMARY:true}
      # å›å¤é£æ ¼ï¼šconservativeï¼ˆä¿å®ˆï¼‰ã€balancedï¼ˆå¹³è¡¡ï¼‰ã€creativeï¼ˆåˆ›æ„ï¼‰
      response-style: ${CHAT_AI_STYLE:balanced}
      # åˆ›é€ æ€§æ°´å¹³ï¼ˆ0.0-1.0ï¼‰
      creativity-level: ${CHAT_AI_CREATIVITY:0.7}
      # å®‰å…¨ç­‰çº§ï¼šlowã€mediumã€high
      safety-level: ${CHAT_AI_SAFETY:high}
      # æ”¯æŒçš„è¯­è¨€åˆ—è¡¨
      supported-languages:
        - zh
        - en
        - ja
        - ko
      # é»˜è®¤è¯­è¨€
      default-language: ${CHAT_AI_DEFAULT_LANG:zh}

  # ========== å¤§è¯­è¨€æ¨¡å‹æœåŠ¡é…ç½® ==========
  llm:
    # é»˜è®¤æœåŠ¡æä¾›å•† (openai/claude/qwen)
    default-provider: ${LLM_DEFAULT_PROVIDER:openai}
    # æ˜¯å¦å¯ç”¨æ•…éšœè½¬ç§» - å½“ä¸»è¦æœåŠ¡ä¸å¯ç”¨æ—¶è‡ªåŠ¨åˆ‡æ¢
    failover-enabled: ${LLM_FAILOVER_ENABLED:true}
    # è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼šround_robin(è½®è¯¢)ã€random(éšæœº)ã€weighted(æƒé‡)
    load-balancing: ${LLM_LOAD_BALANCING:round_robin}

    # OpenAI é…ç½®
    openai:
      enabled: ${LLM_OPENAI_ENABLED:true}
      # APIåŸºç¡€URLï¼Œæ”¯æŒä»£ç†æœåŠ¡ (å›½å†…å¯ç”¨çš„ä»£ç†åœ°å€)
      base-url: ${LLM_OPENAI_BASE_URL:https://api.openai-hk.com}
      # APIå¯†é’¥ (è¯·æ›¿æ¢ä¸ºæ‚¨çš„çœŸå®å¯†é’¥)
      api-key: ${LLM_OPENAI_API_KEY:hk-5y2tsx100002516783d25a5427af18502616fb030a23be51}
      # ç»„ç»‡IDï¼ˆå¯é€‰ï¼Œä¼ä¸šç”¨æˆ·éœ€è¦ï¼‰
      organization: ${LLM_OPENAI_ORG_ID:}
      # è¯·æ±‚è¶…æ—¶æ—¶é—´ (ISO-8601æ ¼å¼ï¼ŒPT2Mè¡¨ç¤º2åˆ†é’Ÿ)
      timeout: ${LLM_OPENAI_TIMEOUT:PT2M}
      # æœ€å¤§é‡è¯•æ¬¡æ•°
      max-retries: ${LLM_OPENAI_MAX_RETRIES:3}
      # æ”¯æŒçš„æ¨¡å‹åˆ—è¡¨
      models:
        - gpt-4o                    # æœ€æ–°å¤šæ¨¡æ€æ¨¡å‹
        - gpt-4o-mini              # è½»é‡ç‰ˆGPT-4
        - gpt-4-turbo              # GPT-4åŠ é€Ÿç‰ˆ
        - gpt-4                    # ç»å…¸GPT-4
        - gpt-3.5-turbo            # æ€§ä»·æ¯”ä¹‹ç‹
        - text-embedding-3-small   # å‘é‡åŒ–æ¨¡å‹(å°)
        - text-embedding-3-large   # å‘é‡åŒ–æ¨¡å‹(å¤§)

    # Anthropic Claude é…ç½®
    anthropic:
      enabled: ${LLM_ANTHROPIC_ENABLED:false}
      # Anthropic Claude APIå¯†é’¥ (éœ€è¦åˆ°Anthropicå®˜ç½‘ç”³è¯·)
      api-key: ${LLM_ANTHROPIC_API_KEY:}
      # APIåŸºç¡€URL (å®˜æ–¹åœ°å€)
      base-url: ${LLM_ANTHROPIC_BASE_URL:https://api.anthropic.com}
      # è¯·æ±‚è¶…æ—¶æ—¶é—´ (Anthropic Claudeå“åº”è¾ƒæ…¢ï¼Œå»ºè®®3åˆ†é’Ÿ)
      timeout: ${LLM_ANTHROPIC_TIMEOUT:PT3M}
      # æœ€å¤§é‡è¯•æ¬¡æ•°
      max-retries: ${LLM_ANTHROPIC_MAX_RETRIES:2}
      # æ”¯æŒçš„æ¨¡å‹åˆ—è¡¨
      models:
        - claude-3-haiku-20240307     # æœ€å¿«é€Ÿåº¦ï¼Œæœ€ä½æˆæœ¬
        - claude-3-sonnet-20240229    # å¹³è¡¡æ€§èƒ½ä¸é€Ÿåº¦
        - claude-3-opus-20240229      # æœ€é«˜æ€§èƒ½
        - claude-3-5-sonnet-20241022  # æœ€æ–°ç‰ˆæœ¬
        - claude-3-5-sonnet-20240620  # ç¨³å®šç‰ˆæœ¬

    # é˜¿é‡Œäº‘é€šä¹‰åƒé—® (Qwen) é…ç½®
    qwen:
      enabled: ${LLM_QWEN_ENABLED:true}
      # APIåŸºç¡€URLï¼Œé€šä¹‰åƒé—®çš„DashScopeæœåŠ¡åœ°å€
      base-url: ${LLM_QWEN_BASE_URL:https://dashscope.aliyuncs.com}
      # APIå¯†é’¥ (è¯·åˆ°é˜¿é‡Œäº‘æ§åˆ¶å°è·å–)
      api-key: ${LLM_QWEN_API_KEY:sk-xxxxxxxxxxxxxxxxxxxxxxxx}
      # è¯·æ±‚è¶…æ—¶æ—¶é—´
      timeout: ${LLM_QWEN_TIMEOUT:PT2M}
      # æœ€å¤§é‡è¯•æ¬¡æ•°
      max-retries: ${LLM_QWEN_MAX_RETRIES:3}
      # æ”¯æŒçš„æ¨¡å‹åˆ—è¡¨
      models:
        # ä¸»åŠ›èŠå¤©æ¨¡å‹
        - qwen-plus                  # æ¨èï¼šæ€§èƒ½ä¸æˆæœ¬å¹³è¡¡
        - qwen-turbo                 # é«˜é€Ÿå“åº”ï¼Œæˆæœ¬æœ€ä½
        - qwen-max                   # æœ€å¼ºæ€§èƒ½ï¼Œå¤æ‚ä»»åŠ¡é¦–é€‰
        - qwen-max-longcontext       # é•¿æ–‡æœ¬å¤„ç†ä¸“ç”¨

        # ä¸“ä¸šæ¨¡å‹
        - qwen-coder                 # ä»£ç ç”Ÿæˆå’Œç†è§£
        - qwen-math                  # æ•°å­¦æ¨ç†ä¸“ç”¨

        # å¤šæ¨¡æ€æ¨¡å‹
        - qwen-vl-plus              # å›¾åƒç†è§£
        - qwen-vl-max               # é«˜çº§è§†è§‰ç†è§£

        # å‘é‡åŒ–æ¨¡å‹
        - text-embedding-v2          # æ–‡æœ¬å‘é‡åŒ–
        - text-embedding-v3          # æ–°ç‰ˆå‘é‡åŒ–

    # é»˜è®¤æ¨¡å‹å‚æ•°
    default-parameters:
      # é»˜è®¤ä½¿ç”¨çš„æ¨¡å‹
      model: ${LLM_DEFAULT_MODEL:gpt-3.5-turbo}
      # æ¸©åº¦å‚æ•°ï¼Œæ§åˆ¶å›ç­”çš„åˆ›é€ æ€§ (0.0-2.0ï¼Œè¶Šé«˜è¶Šæœ‰åˆ›æ„)
      temperature: ${LLM_DEFAULT_TEMPERATURE:0.7}
      # æœ€å¤§ç”Ÿæˆä»¤ç‰Œæ•°
      max-tokens: ${LLM_DEFAULT_MAX_TOKENS:1000}
      # Top-p é‡‡æ ·å‚æ•° (0.0-1.0ï¼Œæ§åˆ¶å€™é€‰è¯èŒƒå›´)
      top-p: ${LLM_DEFAULT_TOP_P:1.0}
      # é¢‘ç‡æƒ©ç½šå‚æ•° (å‡å°‘é‡å¤å†…å®¹)
      frequency-penalty: ${LLM_DEFAULT_FREQ_PENALTY:0.0}
      # å­˜åœ¨æƒ©ç½šå‚æ•° (é¼“åŠ±è°ˆè®ºæ–°è¯é¢˜)
      presence-penalty: ${LLM_DEFAULT_PRES_PENALTY:0.0}

    # æ¨¡å‹ç‰¹å®šå‚æ•°
    model-specific-parameters:
      # GPT-4: æ¸©åº¦ç¨ä½ï¼Œç¡®ä¿å‡†ç¡®æ€§
      'gpt-4':
        temperature: 0.5
        max-tokens: 2000
      # GPT-3.5: é»˜è®¤å¹³è¡¡è®¾ç½®
      '[gpt-3.5-turbo]':
        temperature: 0.7
        max-tokens: 1000
      # é€šä¹‰åƒé—®Plus: å¹³è¡¡è®¾ç½®
      'qwen-plus':
        temperature: 0.7
        max-tokens: 2000
      # é€šä¹‰åƒé—®Max: ä½æ¸©åº¦ï¼Œç¡®ä¿è´¨é‡
      'qwen-max':
        temperature: 0.5
        max-tokens: 4000
      # ä»£ç æ¨¡å‹: æä½æ¸©åº¦ï¼Œç¡®ä¿å‡†ç¡®æ€§
      'qwen-coder':
        temperature: 0.2
        max-tokens: 4000
      'claude-3-haiku-20240307':
        temperature: 0.7
        max-tokens: 4000
      'claude-3-sonnet-20240229':
        temperature: 0.6
        max-tokens: 4000
      'claude-3-opus-20240229':
        temperature: 0.5
        max-tokens: 4000
      'claude-3-5-sonnet-20241022':
        temperature: 0.6
        max-tokens: 8000
      'claude-3-5-sonnet-20240620':
        temperature: 0.6
        max-tokens: 8000

    # é«˜çº§åŠŸèƒ½é…ç½®
    features:
      # æ˜¯å¦å¯ç”¨æµå¼å“åº” (æä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ)
      enable-streaming: ${LLM_ENABLE_STREAMING:true}
      # æ˜¯å¦å¯ç”¨å‡½æ•°è°ƒç”¨ (AgentåŠŸèƒ½å¿…éœ€)
      enable-function-calling: ${LLM_ENABLE_FUNCTIONS:true}
      # æ˜¯å¦å¯ç”¨å“åº”ç¼“å­˜ (æé«˜æ€§èƒ½ï¼Œé™ä½æˆæœ¬)
      enable-response-cache: ${LLM_ENABLE_CACHE:true}
      # å“åº”ç¼“å­˜æ—¶é—´ï¼ˆç§’ï¼‰
      response-cache-ttl: ${LLM_CACHE_TTL:3600}

  # ========== é‚®ä»¶æœåŠ¡é…ç½® ==========
  email:
    # åŸºæœ¬å‘é€é…ç½®
    sender:
      # é»˜è®¤å‘ä»¶äººåœ°å€
      from-address: ${EMAIL_FROM:noreply@baseai.com}
      # é»˜è®¤å‘ä»¶äººåç§°
      from-name: ${EMAIL_FROM_NAME:BaseAIç³»ç»Ÿ}
      # å›å¤åœ°å€
      reply-to: ${EMAIL_REPLY_TO:support@baseai.com}
      # é€€ä¿¡åœ°å€
      bounce-address: ${EMAIL_BOUNCE:bounce@baseai.com}
      # å­—ç¬¦ç¼–ç 
      charset: ${EMAIL_CHARSET:UTF-8}
      # æ˜¯å¦å¯ç”¨HTMLæ ¼å¼
      enable-html: ${EMAIL_ENABLE_HTML:true}
      # æ˜¯å¦å¯ç”¨é‚®ä»¶è·Ÿè¸ª
      enable-tracking: ${EMAIL_ENABLE_TRACKING:false}

    # æŠ•é€’è®¾ç½®
    delivery:
      # æ˜¯å¦å¯ç”¨å¼‚æ­¥å‘é€
      enable-async: ${EMAIL_ASYNC:true}
      # å¼‚æ­¥é˜Ÿåˆ—å¤§å°
      async-queue-size: ${EMAIL_ASYNC_QUEUE:1000}
      # æœ€å¤§é‡è¯•æ¬¡æ•°
      max-retry-attempts: ${EMAIL_MAX_RETRY:3}
      # é‡è¯•å»¶è¿Ÿæ—¶é—´ï¼ˆç§’ï¼‰
      retry-delays:
        - 60    # ç¬¬ä¸€æ¬¡é‡è¯•ï¼š1åˆ†é’Ÿå
        - 300   # ç¬¬äºŒæ¬¡é‡è¯•ï¼š5åˆ†é’Ÿå
        - 900   # ç¬¬ä¸‰æ¬¡é‡è¯•ï¼š15åˆ†é’Ÿå
      # æ‰¹é‡å‘é€å¤§å°
      batch-size: ${EMAIL_BATCH_SIZE:50}
      # æ‰¹é‡å‘é€é—´éš”ï¼ˆæ¯«ç§’ï¼‰
      batch-delay-ms: ${EMAIL_BATCH_DELAY:100}
      # æŠ•é€’è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
      delivery-timeout-seconds: ${EMAIL_DELIVERY_TIMEOUT:30}
      # æ˜¯å¦å¯ç”¨æ­»ä¿¡é˜Ÿåˆ—
      enable-dead-letter-queue: ${EMAIL_ENABLE_DLQ:true}

    # æ¨¡æ¿é…ç½®
    template:
      # æ˜¯å¦å¯ç”¨æ¨¡æ¿åŠŸèƒ½
      enabled: ${EMAIL_TEMPLATE_ENABLED:true}
      # æ¨¡æ¿ç¼“å­˜æ—¶é—´ï¼ˆç§’ï¼‰
      cache-ttl-seconds: ${EMAIL_TEMPLATE_CACHE_TTL:3600}
      # é»˜è®¤æ¨¡æ¿
      default-template: ${EMAIL_DEFAULT_TEMPLATE:system-notification}
      # æ¨¡æ¿æ–‡ä»¶ä½ç½®
      location: ${EMAIL_TEMPLATE_LOCATION:classpath:/email-templates/}
      # æ˜¯å¦å¯ç”¨æ¨¡æ¿ç¼“å­˜
      cache-enabled: ${EMAIL_TEMPLATE_CACHE_ENABLED:true}
      # æ”¯æŒçš„æ¨¡æ¿æ ¼å¼
      supported-formats:
        - html
        - text
      # æ˜¯å¦è‡ªåŠ¨ç”Ÿæˆçº¯æ–‡æœ¬ç‰ˆæœ¬
      auto-generate-text: ${EMAIL_AUTO_TEXT:true}
      # å…¨å±€æ¨¡æ¿å˜é‡
      global-variables:
        system-name: BaseAI
        support-email: support@baseai.com
        website-url: https://baseai.com

  # ========== çŸ­ä¿¡æœåŠ¡é…ç½® ==========
  sms:
    # æœåŠ¡æä¾›å•†é…ç½®
    provider:
      # ä¸»è¦æœåŠ¡å•†
      primary: ${SMS_PRIMARY_PROVIDER:aliyun}
      # å¤‡ç”¨æœåŠ¡å•†åˆ—è¡¨
      fallback-providers:
        - tencent
        - huawei
      # æ˜¯å¦å¯ç”¨æ•…éšœè½¬ç§»
      enable-fallback: ${SMS_ENABLE_FALLBACK:true}
      # æ•…éšœè½¬ç§»é˜ˆå€¼ï¼ˆè¿ç»­å¤±è´¥æ¬¡æ•°ï¼‰
      failover-threshold: ${SMS_FAILOVER_THRESHOLD:3}
      # æœåŠ¡å•†æƒé‡é…ç½®ï¼ˆç”¨äºè´Ÿè½½å‡è¡¡ï¼‰
      weights:
        aliyun: 70
        tencent: 20
        huawei: 10

    # é˜¿é‡Œäº‘çŸ­ä¿¡é…ç½®
    aliyun:
      access-key: ${SMS_ALIYUN_ACCESS_KEY:}
      access-secret: ${SMS_ALIYUN_ACCESS_SECRET:}
      signature: ${SMS_ALIYUN_SIGNATURE:BaseAI}
      region: ${SMS_ALIYUN_REGION:cn-hangzhou}

    # è…¾è®¯äº‘çŸ­ä¿¡é…ç½®
    tencent:
      secret-id: ${SMS_TENCENT_SECRET_ID:}
      secret-key: ${SMS_TENCENT_SECRET_KEY:}
      signature: ${SMS_TENCENT_SIGNATURE:BaseAI}
      region: ${SMS_TENCENT_REGION:ap-guangzhou}

    # å‘é€é™åˆ¶é…ç½®
    rate-limits:
      # å…¨å±€é™åˆ¶
      global:
        per-minute: ${SMS_GLOBAL_PER_MINUTE:100}
        per-hour: ${SMS_GLOBAL_PER_HOUR:1000}
        per-day: ${SMS_GLOBAL_PER_DAY:5000}
      # ç”¨æˆ·çº§åˆ«é™åˆ¶
      user:
        per-minute: ${SMS_USER_PER_MINUTE:5}
        per-hour: ${SMS_USER_PER_HOUR:20}
        per-day: ${SMS_USER_PER_DAY:100}
      # æ‰‹æœºå·çº§åˆ«é™åˆ¶
      phone:
        per-minute: ${SMS_PHONE_PER_MINUTE:1}
        per-hour: ${SMS_PHONE_PER_HOUR:10}
        per-day: ${SMS_PHONE_PER_DAY:20}

    # å†…å®¹é…ç½®
    content:
      # é‡å¤æ£€æµ‹æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰ï¼Œé˜²æ­¢é‡å¤å‘é€
      duplicate-check-minutes: ${SMS_DUPLICATE_CHECK:2}
      # å¤±è´¥åå¯ç”¨éªŒè¯ç çš„æ¬¡æ•°
      enable-captcha-after-failures: ${SMS_CAPTCHA_THRESHOLD:3}
      # çŸ­ä¿¡æ¨¡æ¿é…ç½®
      templates:
        verification-code:
          template-id: ${SMS_TEMPLATE_VERIFICATION:SMS_123456}
          content: "æ‚¨çš„éªŒè¯ç æ˜¯{code}ï¼Œæœ‰æ•ˆæœŸ{expire}åˆ†é’Ÿï¼Œè¯·å‹¿æ³„éœ²ã€‚"
          params:
            - code
            - expire
        security-alert:
          template-id: ${SMS_TEMPLATE_SECURITY:SMS_789012}
          content: "æ‚¨çš„è´¦æˆ·åœ¨{time}å‘ç”Ÿ{action}æ“ä½œï¼Œå¦‚éæœ¬äººæ“ä½œè¯·åŠæ—¶è”ç³»å®¢æœã€‚"
          params:
            - time
            - action
        notification:
          template-id: ${SMS_TEMPLATE_NOTIFICATION:SMS_345678}
          content: "ç³»ç»Ÿé€šçŸ¥ï¼š{message}"
          params:
            - message

  # ========== å®¡è®¡ç³»ç»Ÿé…ç½® ==========
  audit:
    # æ—¥å¿—è®°å½•é…ç½®
    logging:
      # æ˜¯å¦å¯ç”¨å¼‚æ­¥å¤„ç†
      enable-async: ${AUDIT_ASYNC:true}
      # å¼‚æ­¥é˜Ÿåˆ—å¤§å°
      async-queue-size: ${AUDIT_QUEUE_SIZE:10000}
      # æ‰¹é‡å¤„ç†å¤§å°
      batch-size: ${AUDIT_BATCH_SIZE:100}
      # æ‰¹é‡å¤„ç†è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
      batch-timeout-ms: ${AUDIT_BATCH_TIMEOUT:5000}
      # æ˜¯å¦å¯ç”¨å‹ç¼©
      enable-compression: ${AUDIT_COMPRESSION:true}
      # éœ€è¦è®°å½•çš„æ—¥å¿—çº§åˆ«
      log-levels:
        - ERROR
        - WARN
        - INFO
        - DEBUG
      # æ•æ„Ÿå­—æ®µåˆ—è¡¨ï¼ˆå°†è¢«å±è”½ï¼‰
      sensitive-fields:
        - password
        - token
        - key
        - secret
        - apiKey
      # æ˜¯å¦å¯ç”¨å­—æ®µå±è”½
      enable-field-masking: ${AUDIT_FIELD_MASKING:true}

    # æ•°æ®ä¿ç•™ç­–ç•¥
    retention:
      # é»˜è®¤ä¿ç•™å¤©æ•°ï¼ˆ7å¹´ï¼‰
      default-days: ${AUDIT_RETENTION_DAYS:2555}
      # æŒ‰çº§åˆ«çš„ä¿ç•™ç­–ç•¥
      by-level:
        ERROR: ${AUDIT_RETENTION_ERROR:3650}   # é”™è¯¯æ—¥å¿—ä¿ç•™10å¹´
        WARN: ${AUDIT_RETENTION_WARN:1825}     # è­¦å‘Šæ—¥å¿—ä¿ç•™5å¹´
        INFO: ${AUDIT_RETENTION_INFO:365}      # ä¿¡æ¯æ—¥å¿—ä¿ç•™1å¹´
        DEBUG: ${AUDIT_RETENTION_DEBUG:30}     # è°ƒè¯•æ—¥å¿—ä¿ç•™30å¤©
      # æ˜¯å¦å¯ç”¨è‡ªåŠ¨å½’æ¡£
      enable-auto-archive: ${AUDIT_AUTO_ARCHIVE:true}
      # å½’æ¡£é˜ˆå€¼å¤©æ•°
      archive-after-days: ${AUDIT_ARCHIVE_AFTER:365}
      # å½’æ¡£å‹ç¼©æ–¹å¼
      archive-compression: ${AUDIT_ARCHIVE_COMPRESSION:gzip}
      # å½»åº•åˆ é™¤é˜ˆå€¼å¤©æ•°
      purge-after-days: ${AUDIT_PURGE_AFTER:2555}
      # æ˜¯å¦å¯ç”¨æ³•å¾‹ä¿ç•™
      enable-legal-hold: ${AUDIT_LEGAL_HOLD:true}

    # Elasticsearchå­˜å‚¨é…ç½®
    elasticsearch:
      # æ˜¯å¦å¯ç”¨ESå­˜å‚¨
      enabled: ${AUDIT_ES_ENABLED:true}
      # ç´¢å¼•åç§°å‰ç¼€
      index-prefix: ${AUDIT_ES_INDEX_PREFIX:baseai-audit}
      # ç´¢å¼•æ¨¡æ¿åç§°
      index-template: ${AUDIT_ES_TEMPLATE:audit-template}
      # æ¯ä¸ªç´¢å¼•çš„åˆ†ç‰‡æ•°
      shards-per-index: ${AUDIT_ES_SHARDS:1}
      # æ¯ä¸ªç´¢å¼•çš„å‰¯æœ¬æ•°
      replicas-per-index: ${AUDIT_ES_REPLICAS:1}
      # åˆ·æ–°é—´éš”
      refresh-interval: ${AUDIT_ES_REFRESH:30s}
      # æ˜¯å¦å¯ç”¨ç´¢å¼•ç”Ÿå‘½å‘¨æœŸç®¡ç†
      enable-ilm: ${AUDIT_ES_ILM:true}
      # ç”Ÿå‘½å‘¨æœŸç®¡ç†ç­–ç•¥
      ilm-policy:
        hot-phase-days: 7     # çƒ­é˜¶æ®µï¼š7å¤©
        warm-phase-days: 30   # æ¸©é˜¶æ®µï¼š30å¤©
        cold-phase-days: 90   # å†·é˜¶æ®µï¼š90å¤©
        delete-phase-days: 2555 # åˆ é™¤é˜¶æ®µï¼š7å¹´

    # å®Œæ•´æ€§æ£€æŸ¥é…ç½®
    integrity:
      # æ˜¯å¦å¯ç”¨å®Œæ•´æ€§æ£€æŸ¥
      enabled: ${AUDIT_INTEGRITY_ENABLED:true}
      # æ£€æŸ¥è°ƒåº¦è¡¨è¾¾å¼ï¼ˆæ¯å¤©å‡Œæ™¨2ç‚¹ï¼‰
      schedule: ${AUDIT_INTEGRITY_SCHEDULE:0 2 * * *}
      # æ£€æŸ¥æ–¹å¼ï¼šchecksumã€countã€sampling
      check-method: ${AUDIT_INTEGRITY_METHOD:checksum}
      # é‡‡æ ·æ£€æŸ¥æ¯”ä¾‹ï¼ˆå½“ä½¿ç”¨samplingæ–¹æ³•æ—¶ï¼‰
      sampling-ratio: ${AUDIT_INTEGRITY_SAMPLING:0.1}

    # æŠ¥å‘Šé…ç½®
    reporting:
      # æ˜¯å¦å¯ç”¨æŠ¥å‘ŠåŠŸèƒ½
      enabled: ${AUDIT_REPORT_ENABLED:true}
      # æŠ¥å‘Šè¾“å‡ºä½ç½®
      output-location: ${AUDIT_REPORT_OUTPUT:/tmp/audit-reports/}
      # æŠ¥å‘Šæ ¼å¼ï¼šPDFã€EXCELã€CSV
      default-format: ${AUDIT_REPORT_FORMAT:PDF}
      # è‡ªåŠ¨æŠ¥å‘Šè°ƒåº¦ï¼ˆæ¯æœˆ1å·ç”Ÿæˆæœˆåº¦æŠ¥å‘Šï¼‰
      auto-schedule: ${AUDIT_REPORT_SCHEDULE:0 0 1 * *}
      # æŠ¥å‘Šä¿ç•™å¤©æ•°
      report-retention-days: ${AUDIT_REPORT_RETENTION:365}

  # ========== ç¼“å­˜é…ç½® ==========
  cache:
    # Redisç¼“å­˜é…ç½®
    redis:
      # é»˜è®¤è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰ï¼Œé»˜è®¤ 1 å°æ—¶
      default-ttl-seconds: ${CACHE_REDIS_DEFAULT_TTL:3600}
      # æœ€å¤§è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰ï¼Œæœ€å¤§ 24 å°æ—¶
      max-ttl-seconds: ${CACHE_REDIS_MAX_TTL:86400}
      # é”®åå‰ç¼€
      key-prefix: ${CACHE_REDIS_PREFIX:baseai:}
      # æ˜¯å¦å¯ç”¨å‹ç¼©
      enable-compression: ${CACHE_REDIS_COMPRESSION:true}
      # å‹ç¼©é˜ˆå€¼ï¼ˆå­—èŠ‚ï¼‰
      compression-threshold-bytes: ${CACHE_REDIS_COMPRESSION_THRESHOLD:1024}
      # æœ€å¤§é”®åé•¿åº¦
      max-key-length: ${CACHE_REDIS_MAX_KEY_LENGTH:250}

    # åº”ç”¨çº§ç¼“å­˜é…ç½®
    application:
      # é…ç½®ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰
      config-cache-ttl-seconds: ${CACHE_APP_CONFIG_TTL:300}
      # ç”¨æˆ·ä¼šè¯ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰
      user-session-cache-ttl-seconds: ${CACHE_APP_SESSION_TTL:1800}
      # APIå“åº”ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰
      api-response-cache-ttl-seconds: ${CACHE_APP_API_TTL:60}
      # é™æ€å†…å®¹ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰
      static-content-cache-ttl-seconds: ${CACHE_APP_STATIC_TTL:3600}
      # æ˜¯å¦å¯ç”¨ç¼“å­˜é¢„çƒ­
      enable-cache-warming: ${CACHE_APP_WARMING:true}
      # ç¼“å­˜é¢„çƒ­è°ƒåº¦è¡¨è¾¾å¼ï¼ˆæ¯6å°æ—¶ï¼‰
      cache-warming-schedule: ${CACHE_APP_WARMING_SCHEDULE:0 0 */6 * * *}
      # æœ€å¤§ç¼“å­˜å¤§å°ï¼ˆMBï¼‰
      max-cache-size-mb: ${CACHE_APP_MAX_SIZE:512}
      # ç¼“å­˜æ·˜æ±°ç­–ç•¥ï¼šLRUã€LFUã€FIFO
      eviction-policy: ${CACHE_APP_EVICTION:LRU}

  # ========== å¼‚æ­¥å¤„ç†é…ç½® ==========
  async:
    # çº¿ç¨‹æ± æ ¸å¿ƒå¤§å°
    core-pool-size: ${ASYNC_CORE_POOL_SIZE:2}
    # çº¿ç¨‹æ± æœ€å¤§å¤§å°
    max-pool-size: ${ASYNC_MAX_POOL_SIZE:8}
    # é˜Ÿåˆ—å®¹é‡
    queue-capacity: ${ASYNC_QUEUE_CAPACITY:500}
    # çº¿ç¨‹åç§°å‰ç¼€
    thread-name-prefix: "BaseAI-Async-"
    # çº¿ç¨‹ä¿æ´»æ—¶é—´ï¼ˆç§’ï¼‰
    keep-alive-seconds: ${ASYNC_KEEP_ALIVE:60}
    # æ˜¯å¦å…è®¸æ ¸å¿ƒçº¿ç¨‹è¶…æ—¶
    allow-core-thread-timeout: ${ASYNC_ALLOW_CORE_TIMEOUT:true}
    # æ‹’ç»ç­–ç•¥ï¼šABORTã€CALLER_RUNSã€DISCARDã€DISCARD_OLDEST
    rejection-policy: ${ASYNC_REJECTION_POLICY:CALLER_RUNS}

  # ========== å®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨é…ç½® ==========
  scheduling:
    # å…¨å±€å¼€å…³ï¼šæ˜¯å¦å¯ç”¨å®šæ—¶ä»»åŠ¡åŠŸèƒ½
    enabled: true
    # çº¿ç¨‹æ± é…ç½®
    pool:
      # çº¿ç¨‹æ± å¤§å°ï¼ˆæ ¸å¿ƒçº¿ç¨‹æ•°5-10-15-50ï¼‰
      size: 15
      # æ˜¯å¦å…è®¸æ ¸å¿ƒçº¿ç¨‹è¶…æ—¶ï¼ˆtrueï¼šç©ºé—²çº¿ç¨‹ä¼šè¢«å›æ”¶ï¼ŒèŠ‚çœèµ„æºï¼›falseï¼šæ ¸å¿ƒçº¿ç¨‹å§‹ç»ˆä¿æŒæ´»è·ƒçŠ¶æ€ï¼‰
      allow-core-thread-timeout: false
      # çº¿ç¨‹ç©ºé—²æ—¶é—´ï¼ˆç§’ï¼‰ï¼Œå½“ allow-core-thread-timeout ä¸º true æ—¶ç”Ÿæ•ˆ
      keep-alive-seconds: 60
    # çº¿ç¨‹é…ç½®
    thread:
      # çº¿ç¨‹åç§°å‰ç¼€
      name-prefix: "BaseAI-Scheduled-"
      # çº¿ç¨‹ä¼˜å…ˆçº§ (1-10)
      priority: 5
    # å…³é—­è¡Œä¸ºé…ç½®
    shutdown:
      # åº”ç”¨å…³é—­æ—¶æ˜¯å¦ç­‰å¾…æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡å®Œæˆ
      wait-for-tasks-to-complete: true
      # ç­‰å¾…ä»»åŠ¡å®Œæˆçš„æœ€é•¿æ—¶é—´ï¼ˆç§’ï¼‰
      await-termination-seconds: 120

  # ========== æ–‡ä»¶å­˜å‚¨é…ç½® ==========
  storage:
    # æœ¬åœ°å­˜å‚¨é…ç½®
    local:
      # æ˜¯å¦å¯ç”¨æœ¬åœ°å­˜å‚¨
      enabled: ${STORAGE_LOCAL_ENABLED:true}
      # å­˜å‚¨æ ¹è·¯å¾„
      base-path: ${STORAGE_LOCAL_BASE_PATH:./storage}
      # å•ä¸ªæ–‡ä»¶æœ€å¤§å¤§å°
      max-file-size: ${STORAGE_LOCAL_MAX_SIZE:10MB}
      # å…è®¸çš„æ–‡ä»¶ç±»å‹
      allowed-types:
        - pdf
        - txt
        - md
        - docx
        - doc
        - jpg
        - jpeg
        - png
        - gif
      # æ˜¯å¦å¯ç”¨æ–‡ä»¶æ ¡éªŒ
      enable-checksum: ${STORAGE_LOCAL_CHECKSUM:true}
      # æ ¡éªŒç®—æ³•ï¼šMD5ã€SHA1ã€SHA256
      checksum-algorithm: ${STORAGE_LOCAL_CHECKSUM_ALG:SHA256}

    # äº‘å­˜å‚¨é…ç½®ï¼ˆå¯é€‰ï¼‰
    cloud:
      # æ˜¯å¦å¯ç”¨äº‘å­˜å‚¨
      enabled: ${STORAGE_CLOUD_ENABLED:false}
      # äº‘å­˜å‚¨æä¾›å•†ï¼šossã€s3ã€cosç­‰
      provider: ${STORAGE_CLOUD_PROVIDER:oss}
      # æœåŠ¡ç«¯ç‚¹
      endpoint: ${STORAGE_CLOUD_ENDPOINT:}
      # è®¿é—®å¯†é’¥
      access-key: ${STORAGE_CLOUD_ACCESS_KEY:}
      # å¯†é’¥
      secret-key: ${STORAGE_CLOUD_SECRET_KEY:}
      # å­˜å‚¨æ¡¶åç§°
      bucket: ${STORAGE_CLOUD_BUCKET:baseai-storage}
      # æ˜¯å¦å¯ç”¨CDNåŠ é€Ÿ
      enable-cdn: ${STORAGE_CLOUD_CDN:false}
      # CDNåŸŸå
      cdn-domain: ${STORAGE_CLOUD_CDN_DOMAIN:}
